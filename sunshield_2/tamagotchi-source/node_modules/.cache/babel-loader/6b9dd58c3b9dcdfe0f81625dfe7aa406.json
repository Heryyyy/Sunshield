{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/ashpool/Repositories/tamagotchi-virtual-pet/src/containers/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport disasterPet from \"../assets/character/disaster-pet.svg\";\nimport exercisePet from \"../assets/character/exercise-pet.svg\";\nimport foodPet from \"../assets/character/food-pet.svg\";\nimport mischiefPet from \"../assets/character/mischief-pet.svg\";\nimport sickPet from \"../assets/character/sick-pet.svg\";\nimport tricksPet from \"../assets/character/tricks-pet.svg\";\nimport welcomePet from \"../assets/character/welcome-pet.svg\";\nimport { useParams } from 'react-router-dom';\nimport { accurateInterval } from '../utils/helpers.js';\nimport Copyright from '../components/Copyright';\nimport Character from '../components/Character';\nimport LinearProgressWithLabel from '../components/LinearProgressWithLabel';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { StaticBanner } from 'material-ui-banner';\nimport { makeStyles } from '@material-ui/core/styles';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    flexDirection: 'column'\n  },\n  paper: {\n    padding: theme.spacing(2),\n    margin: '2rem auto',\n    maxWidth: '50%',\n    width: '50%'\n  },\n  avatarLarge: {\n    width: 72,\n    height: 72\n  },\n  buttonWrapper: {\n    position: 'relative' // display: 'inline-flex',\n    // alignItems: 'center',\n\n  },\n  button: {\n    position: 'relative',\n    overflow: 'hidden' // Ensure child elements don't overflow\n\n  },\n  circularProgress: {\n    position: 'absolute',\n    top: '30%',\n    left: '45%',\n    transform: 'translate(-50%, -50%)',\n    color: yellow // Optional: Change color if needed\n\n  }\n})); //Helper functions\n\nfunction status(response) {\n  if (response.status >= 200 && response.status < 300) {\n    return Promise.resolve(response);\n  } else if (response.status === 429) {\n    return Promise.resolve(response);\n  } else {\n    return Promise.reject(new Error(response.statusText));\n  }\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nconst stayInRange = stat => {\n  if (stat >= 0 && stat <= 100) return stat;else if (stat > 100) return 100;else return 0;\n};\n\nconst getCharacter = eventType => {\n  let eventGraphic;\n\n  switch (eventType) {\n    case 'Natural Disaster':\n      eventGraphic = disasterPet;\n      break;\n\n    case 'Food':\n      eventGraphic = foodPet;\n      break;\n\n    case 'Mischief':\n      eventGraphic = mischiefPet;\n      break;\n\n    case 'Disease':\n      eventGraphic = sickPet;\n      break;\n\n    case 'Tricks':\n      eventGraphic = tricksPet;\n      break;\n\n    case 'Exercise':\n      eventGraphic = exercisePet;\n      break;\n\n    default:\n      eventGraphic = welcomePet;\n  }\n\n  return eventGraphic;\n};\n\nexport default function App() {\n  _s();\n\n  const [name, setName] = useState('Pippin');\n  const [dayDuration, setDayDuration] = useState(1000); //in miliseconds\n\n  const [age, setAge] = useState(0); // const [health, setHealth] = useState(100);\n  // const [hunger, setHunger] = useState(0);\n  // const [happiness, setHappiness] = useState(100);\n\n  const [sunburn, setSunburn] = useState(0);\n  const [boredom, setBoredom] = useState(0);\n  const [outdoor, setOutdoor] = useState(true);\n  const [sunscreen, setSunscreen] = useState(false);\n  const [hat, setHat] = useState(false);\n  const [uv, setUv] = useState(5);\n  const [sunscreenDuration, setSunscreenDuration] = useState(0);\n  const [gameEnd, setGameEnd] = useState(false);\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const timeoutRef = useRef();\n  const eventTimeoutRef = useRef();\n  const classes = useStyles();\n  const {\n    petName,\n    dayDurationInSeconds\n  } = useParams();\n  const outdoorRef = useRef(outdoor);\n  const sunscreenRef = useRef(sunscreen);\n  const uvRef = useRef(uv);\n\n  const beginLife = () => {\n    let timeOutInfo = accurateInterval(() => {\n      petDay();\n    }, dayDuration);\n    timeoutRef.current = timeOutInfo; //console.log(timeoutRef.current)\n  }; //   const handleNextEvent = (nextEvent) => {\n  //   \t/*timeoutRef.current is null when starting a new game. \n  //   \tThis condition also keeps the app from fetching when the game has ended\n  //   \t*/\n  //   \tif (timeoutRef.current !== null) {\n  // \t  \tlet nextEventInfo = accurateInterval(() => {\n  // \t          getNextEvent();\n  // \t        }, nextEvent)\n  // \t    eventTimeoutRef.current = nextEventInfo;\n  //     \t//console.log(eventTimeoutRef.current);\n  //     }\n  //   }\n  //   const getNextEvent = () => {\n  // \t\tfetch('https://www.virtual-pet.uk/v1/event')\n  // \t\t\t.then(status)\n  // \t\t\t.then(json)\n  // \t\t\t.then(function(data) {\n  // \t\t\t    if(data.type === 'Error'){\n  // \t\t\t    \t console.log('Request failed', data);\n  // \t\t\t    \t if (eventTimeoutRef.current) {\n  // \t\t\t\t\t\t    eventTimeoutRef.current.cancel();\n  // \t\t\t\t\t\t    eventTimeoutRef.current = null;\n  // \t\t\t\t\t\t }\n  // \t\t\t    \t handleNextEvent(data.nextEvent * dayDuration);\n  // \t\t\t    } else {\n  // \t\t\t    \tconsole.log('Request succeeded with JSON response', data);\n  // \t\t\t\t    setHealth((prev) => stayInRange(prev + data.impact.health));\n  // \t\t\t\t\tsetHunger((prev) => stayInRange(prev + data.impact.hunger));\n  // \t\t\t\t\tsetHappiness((prev) => stayInRange(prev + data.impact.happiness));\n  // \t\t\t\t\thandleOpenBanner(data.type.toUpperCase() + \"! \" + data.title + \": \" + data.description + \" Impact, health: \" + data.impact.health + \" hunger: \" + data.impact.hunger + \" happiness: \" + data.impact.happiness, getCharacter(data.type));\n  // \t\t\t\t\tif (eventTimeoutRef.current) {\n  // \t\t\t\t\t\t    eventTimeoutRef.current.cancel();\n  // \t\t\t\t\t\t    eventTimeoutRef.current = null;\n  // \t\t\t\t\t\t }\n  // \t\t\t\t\thandleNextEvent(data.nextEvent * dayDuration); \n  // \t\t\t\t}\t\t\t    \t\n  // \t\t\t }).catch(function(error) {\n  // \t\t\t    console.log('Request failed', error);\n  // \t\t\t });\n  //   }\n\n\n  const petDay = () => {\n    setAge(prevAge => {\n      const newAge = prevAge + 1;\n\n      if (newAge % 5 === 0) {\n        setUv(Math.floor(Math.random() * 14) + 1);\n      }\n\n      return newAge;\n    });\n\n    if (outdoorRef.current) {\n      if (sunscreenRef.current) {\n        setSunscreenDuration(prevDuration => {\n          if (prevDuration > 0) {\n            return prevDuration - 1;\n          } else {\n            setSunscreen(false);\n            return 0;\n          }\n        });\n        setSunburn(prevSunburn => stayInRange(prevSunburn + uvRef.current / 2));\n      } else {\n        setSunburn(prevSunburn => stayInRange(prevSunburn + uvRef.current));\n      }\n\n      setBoredom(prevBoredom => stayInRange(prevBoredom - 5));\n    } else {\n      setSunburn(prevSunburn => stayInRange(prevSunburn - 10));\n      setBoredom(prevBoredom => stayInRange(prevBoredom + 5));\n    }\n  }; //   const cleanPet = () => {\n  // \tif (!gameEnd) {\n  // \t\tsetHealth((prev) => stayInRange(prev + 1));\n  // \t}\n  // }\n  // const feedPet = () => {\n  // \tif (!gameEnd) {\n  // \t\tsetHunger((prev) => stayInRange(prev - 1));\n  // \t}\n  // }\n  // const playPet = () => {\n  // \tif (!gameEnd) {\n  // \t\tsetHappiness((prev) => stayInRange(prev + (Math.floor(Math.random() * 5) + 1))); // random reduction between 1 -> 5)\n  // \t}\n  // }\n\n\n  const changeOutdoor = () => {\n    if (!gameEnd) {\n      setOutdoor(prev => !prev);\n    }\n  };\n\n  const goInside = () => {\n    if (!gameEnd) {\n      setOutdoor(false);\n    }\n  };\n\n  const goOutside = () => {\n    if (!gameEnd) {\n      setOutdoor(true);\n    }\n  };\n\n  const applySunscreen = () => {\n    if (!gameEnd) {\n      setSunscreen(true);\n      setSunscreenDuration(2);\n    }\n  };\n\n  const resetGame = () => {\n    setAge(0);\n    setSunburn(0);\n    setBoredom(0);\n    setSunscreen(false);\n    setGameEnd(false);\n  }; //helper functions\n\n\n  const handleDialogClose = () => {\n    setDialogOpen(false);\n  };\n\n  const handleOpenBanner = useCallback((text, eventTypeGraphic) => StaticBanner.show({\n    icon: /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 11\n    }, this),\n    iconProps: {\n      src: eventTypeGraphic,\n      className: classes.avatarLarge\n    },\n    open: true,\n    label: text\n  }), [classes.avatarLarge]);\n\n  const cleanup = () => {\n    //Cancel timers\n    if (timeoutRef.current) {\n      timeoutRef.current.cancel();\n    }\n\n    if (eventTimeoutRef.current) {\n      eventTimeoutRef.current.cancel();\n    }\n\n    timeoutRef.current = null;\n    eventTimeoutRef.current = null;\n  }; //Effects\n\n\n  useEffect(() => {\n    outdoorRef.current = outdoor;\n  }, [outdoor]);\n  useEffect(() => {\n    sunscreenRef.current = sunscreen;\n  }, [sunscreen]);\n  useEffect(() => {\n    uvRef.current = uv;\n  }, [uv]);\n  useEffect(() => {\n    if (sunburn == 100 || boredom == 100) {\n      setDialogOpen(true);\n      setGameEnd(true);\n    }\n  }, [sunburn, boredom]);\n  useEffect(() => {\n    if (!gameEnd) {\n      // Set pet name if provided\n      if (petName !== undefined) {\n        setName(decodeURIComponent(petName));\n      } // Set day duration\n\n\n      if (dayDurationInSeconds !== undefined && !Number.isNaN(parseInt(dayDurationInSeconds))) {\n        let inputedDuration = parseInt(dayDurationInSeconds);\n\n        if (inputedDuration <= 0) {\n          setDayDuration(1000);\n        } else if (inputedDuration > 60) {\n          setDayDuration(60 * 1000);\n        } else {\n          setDayDuration(inputedDuration * 1000);\n        }\n      } else {\n        setDayDuration(1000);\n      } // Initialize game state\n\n\n      setSunburn(0);\n      setBoredom(0);\n      setOutdoor(true);\n      setSunscreen(false);\n      setSunscreenDuration(0);\n      setUv(5); // Starting UV index\n      // Start the game loop\n\n      beginLife(); // Schedule the first UV change\n\n      const uvChangeInterval = setInterval(() => {\n        setUv(Math.floor(Math.random() * 14) + 1);\n      }, 5 * dayDuration); // Cleanup function\n\n      return () => {\n        cleanup();\n        clearInterval(uvChangeInterval);\n      };\n    } else {\n      cleanup();\n    }\n  }, [gameEnd, petName, dayDurationInSeconds, dayDuration]);\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(CssBaseline, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(StaticBanner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      component: \"main\",\n      className: classes.root,\n      children: [/*#__PURE__*/_jsxDEV(Paper, {\n        className: classes.paper,\n        children: /*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          spacing: 2,\n          children: [/*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 8,\n            sm: 8,\n            md: 6,\n            container: true,\n            children: /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: true,\n              container: true,\n              direction: \"column\",\n              spacing: 2,\n              children: /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: true,\n                children: [/*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"h2\",\n                  children: name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 398,\n                  columnNumber: 18\n                }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"h6\",\n                  children: [\"Age: \", age]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 401,\n                  columnNumber: 18\n                }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body1\",\n                  children: [\"Today's UV Index: \", uv]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 404,\n                  columnNumber: 6\n                }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body1\",\n                  children: [\"You are currently \", outdoor ? \"outdoors\" : \"indoors\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 407,\n                  columnNumber: 6\n                }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body1\",\n                  children: \"Sunburn:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 410,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(LinearProgressWithLabel, {\n                  value: sunburn\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 413,\n                  columnNumber: 18\n                }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body1\",\n                  children: \"Boredom:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 414,\n                  columnNumber: 18\n                }, this), /*#__PURE__*/_jsxDEV(LinearProgressWithLabel, {\n                  value: boredom\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 417,\n                  columnNumber: 18\n                }, this), /*#__PURE__*/_jsxDEV(ButtonGroup, {\n                  color: \"primary\",\n                  variant: \"contained\",\n                  \"aria-label\": \"outlined primary button group\",\n                  children: [/*#__PURE__*/_jsxDEV(Button, {\n                    disabled: gameEnd,\n                    onClick: outdoor ? goInside : goOutside,\n                    children: outdoor ? 'Go Inside' : 'Play Outside'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 420,\n                    columnNumber: 6\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    disabled: gameEnd || sunscreenDuration > 0,\n                    onClick: applySunscreen,\n                    className: classes.button,\n                    children: [\"Apply Sunscreen\", sunscreenDuration > 0 && /*#__PURE__*/_jsxDEV(CircularProgress, {\n                      variant: \"static\",\n                      value: sunscreenDuration / 2 * 100,\n                      size: 24 // Adjust size to fit your button\n                      ,\n                      className: classes.circularProgress\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 430,\n                      columnNumber: 7\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 423,\n                    columnNumber: 6\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 419,\n                  columnNumber: 18\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  onClick: resetGame,\n                  children: gameEnd ? \"Play again!\" : \"Reset Game\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 440,\n                  columnNumber: 8\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 397,\n                columnNumber: 16\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 396,\n              columnNumber: 14\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 12\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 4,\n            sm: 4,\n            md: 6\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 444,\n            columnNumber: 12\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 10\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(Copyright, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 392,\n      columnNumber: 3\n    }, this), gameEnd && /*#__PURE__*/_jsxDEV(Dialog, {\n      open: dialogOpen,\n      onClose: handleDialogClose,\n      \"aria-labelledby\": \"alert-dialog-title\",\n      \"aria-describedby\": \"alert-dialog-description\",\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        id: \"alert-dialog-title\",\n        children: \"Game Over.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: /*#__PURE__*/_jsxDEV(DialogContentText, {\n          id: \"alert-dialog-description\",\n          children: \"Great job! Let's play again!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 459,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleDialogClose,\n          color: \"primary\",\n          children: \"Close\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: resetGame,\n          color: \"primary\",\n          autoFocus: true,\n          children: \"Start Over!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 464,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 452,\n      columnNumber: 8\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 389,\n    columnNumber: 4\n  }, this);\n}\n\n_s(App, \"zane/whOWSYZ6m1FsmthN8HXdRQ=\", false, function () {\n  return [useStyles, useParams];\n});\n\n_c = App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/home/ashpool/Repositories/tamagotchi-virtual-pet/src/containers/App.js"],"names":["React","useState","useEffect","useRef","useCallback","useParams","accurateInterval","Copyright","Character","LinearProgressWithLabel","Button","ButtonGroup","CssBaseline","Paper","Grid","Typography","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","StaticBanner","makeStyles","CircularProgress","useStyles","theme","root","flexGrow","alignItems","justifyContent","flexDirection","paper","padding","spacing","margin","maxWidth","width","avatarLarge","height","buttonWrapper","position","button","overflow","circularProgress","top","left","transform","color","yellow","status","response","Promise","resolve","reject","Error","statusText","json","stayInRange","stat","getCharacter","eventType","eventGraphic","disasterPet","foodPet","mischiefPet","sickPet","tricksPet","exercisePet","welcomePet","App","name","setName","dayDuration","setDayDuration","age","setAge","sunburn","setSunburn","boredom","setBoredom","outdoor","setOutdoor","sunscreen","setSunscreen","hat","setHat","uv","setUv","sunscreenDuration","setSunscreenDuration","gameEnd","setGameEnd","dialogOpen","setDialogOpen","timeoutRef","eventTimeoutRef","classes","petName","dayDurationInSeconds","outdoorRef","sunscreenRef","uvRef","beginLife","timeOutInfo","petDay","current","prevAge","newAge","Math","floor","random","prevDuration","prevSunburn","prevBoredom","changeOutdoor","prev","goInside","goOutside","applySunscreen","resetGame","handleDialogClose","handleOpenBanner","text","eventTypeGraphic","show","icon","iconProps","src","className","open","label","cleanup","cancel","undefined","decodeURIComponent","Number","isNaN","parseInt","inputedDuration","uvChangeInterval","setInterval","clearInterval"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useRef, useCallback} from 'react';\nimport disasterPet from '../assets/character/disaster-pet.svg';\nimport exercisePet from '../assets/character/exercise-pet.svg';\nimport foodPet from '../assets/character/food-pet.svg';\nimport mischiefPet from '../assets/character/mischief-pet.svg';\nimport sickPet from '../assets/character/sick-pet.svg';\nimport tricksPet from '../assets/character/tricks-pet.svg';\nimport welcomePet from '../assets/character/welcome-pet.svg';\nimport {useParams} from 'react-router-dom';\nimport {accurateInterval} from '../utils/helpers.js';\nimport Copyright from '../components/Copyright';\nimport Character from '../components/Character';\nimport LinearProgressWithLabel from '../components/LinearProgressWithLabel';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { StaticBanner } from 'material-ui-banner';\nimport { makeStyles } from '@material-ui/core/styles';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\n\nconst useStyles = makeStyles((theme) => ({\n root: {\n    flexGrow: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    flexDirection: 'column',\n  },\n  paper: {\n    padding: theme.spacing(2),\n    margin: '2rem auto',\n    maxWidth: '50%',\n\twidth: '50%',\n  },\n  avatarLarge: {\n  \twidth: 72,\n    height: 72,\n  },\n  buttonWrapper: {\n    position: 'relative',\n    // display: 'inline-flex',\n    // alignItems: 'center',\n  },\n  button: {\n    position: 'relative',\n    overflow: 'hidden', // Ensure child elements don't overflow\n  },\n  circularProgress: {\n    position: 'absolute',\n    top: '30%',\n    left: '45%',\n    transform: 'translate(-50%, -50%)',\n    color: yellow, // Optional: Change color if needed\n  },\n  }));\n\n//Helper functions\n \n function status(response) {\n  if (response.status >= 200 && response.status < 300) {\n    return Promise.resolve(response)\n  } else if (response.status === 429){\n    return Promise.resolve(response)\n  }else {\n    return Promise.reject(new Error(response.statusText))\n  }\n }\n\n function json(response) {\n  return response.json()\n }\n\n const stayInRange = (stat) => {\n  \tif (stat >= 0 && stat <= 100)\n\t    return stat;\n\t else if (stat > 100)\n\t    return 100;\n\telse\n\t    return 0;\n  }\n\nconst getCharacter = (eventType) => {\n  \n  let eventGraphic;\n\n  switch(eventType) {\n\tcase 'Natural Disaster':\n\t\teventGraphic = disasterPet;\n\t\tbreak;\n\tcase 'Food':\n\t\teventGraphic = foodPet;\n\t\tbreak;\n\tcase 'Mischief':\n\t\teventGraphic = mischiefPet;\n\t\tbreak;\n\tcase 'Disease':\n\t\teventGraphic = sickPet;\n\t\tbreak;\n\tcase 'Tricks':\n\t\teventGraphic = tricksPet;\n\t\tbreak;\n\tcase 'Exercise':\n\t\teventGraphic = exercisePet;\n\t\tbreak;\n\tdefault:\n\t\teventGraphic = welcomePet;\n\t}\n\n\treturn eventGraphic;\n}\n\n\nexport default function App() {\n\nconst [name, setName] = useState('Pippin');\nconst [dayDuration, setDayDuration] = useState(1000); //in miliseconds\nconst [age, setAge] = useState(0);\n\n\n\n// const [health, setHealth] = useState(100);\n// const [hunger, setHunger] = useState(0);\n// const [happiness, setHappiness] = useState(100);\n\nconst [sunburn, setSunburn] = useState(0);\nconst [boredom, setBoredom] = useState(0);\nconst [outdoor, setOutdoor] = useState(true);\nconst [sunscreen, setSunscreen] = useState(false);\nconst [hat, setHat] = useState(false);\nconst [uv, setUv] = useState(5);\nconst [sunscreenDuration, setSunscreenDuration] = useState(0);\n\nconst [gameEnd, setGameEnd] = useState(false);\nconst [dialogOpen, setDialogOpen] = useState(false);\nconst timeoutRef = useRef();\nconst eventTimeoutRef = useRef();\nconst classes = useStyles();\nconst {petName, dayDurationInSeconds} = useParams();\n\nconst outdoorRef = useRef(outdoor);\nconst sunscreenRef = useRef(sunscreen);\nconst uvRef = useRef(uv);\n\n\n\n\n const beginLife = () => {\n    let timeOutInfo = accurateInterval(() => {\n          petDay();\n        }, dayDuration) \n    timeoutRef.current = timeOutInfo;\n    //console.log(timeoutRef.current)\n }\n\n//   const handleNextEvent = (nextEvent) => {\n//   \t/*timeoutRef.current is null when starting a new game. \n//   \tThis condition also keeps the app from fetching when the game has ended\n//   \t*/\n//   \tif (timeoutRef.current !== null) {\n// \t  \tlet nextEventInfo = accurateInterval(() => {\n// \t          getNextEvent();\n// \t        }, nextEvent)\n// \t    eventTimeoutRef.current = nextEventInfo;\n//     \t//console.log(eventTimeoutRef.current);\n//     }\n//   }\n\n//   const getNextEvent = () => {\n  \t\n// \t\tfetch('https://www.virtual-pet.uk/v1/event')\n// \t\t\t.then(status)\n// \t\t\t.then(json)\n// \t\t\t.then(function(data) {\n// \t\t\t    if(data.type === 'Error'){\n// \t\t\t    \t console.log('Request failed', data);\n// \t\t\t    \t if (eventTimeoutRef.current) {\n// \t\t\t\t\t\t    eventTimeoutRef.current.cancel();\n// \t\t\t\t\t\t    eventTimeoutRef.current = null;\n// \t\t\t\t\t\t }\n// \t\t\t    \t handleNextEvent(data.nextEvent * dayDuration);\n// \t\t\t    } else {\n// \t\t\t    \tconsole.log('Request succeeded with JSON response', data);\n// \t\t\t\t    setHealth((prev) => stayInRange(prev + data.impact.health));\n// \t\t\t\t\tsetHunger((prev) => stayInRange(prev + data.impact.hunger));\n// \t\t\t\t\tsetHappiness((prev) => stayInRange(prev + data.impact.happiness));\n// \t\t\t\t\thandleOpenBanner(data.type.toUpperCase() + \"! \" + data.title + \": \" + data.description + \" Impact, health: \" + data.impact.health + \" hunger: \" + data.impact.hunger + \" happiness: \" + data.impact.happiness, getCharacter(data.type));\n// \t\t\t\t\tif (eventTimeoutRef.current) {\n// \t\t\t\t\t\t    eventTimeoutRef.current.cancel();\n// \t\t\t\t\t\t    eventTimeoutRef.current = null;\n// \t\t\t\t\t\t }\n// \t\t\t\t\thandleNextEvent(data.nextEvent * dayDuration); \n// \t\t\t\t}\t\t\t    \t\n\n// \t\t\t }).catch(function(error) {\n// \t\t\t    console.log('Request failed', error);\n// \t\t\t });\n\t\t  \t\n//   }\n\n const petDay = () => {\n\tsetAge((prevAge) => {\n\t  const newAge = prevAge + 1;\n\t  if (newAge % 5 === 0) {\n\t\tsetUv(Math.floor(Math.random() * 14) + 1);\n\t  }\n\t  return newAge;\n\t});\n  \n\tif (outdoorRef.current) {\n\t  if (sunscreenRef.current) {\n\t\tsetSunscreenDuration((prevDuration) => {\n\t\t  if (prevDuration > 0) {\n\t\t\treturn prevDuration - 1;\n\t\t  } else {\n\t\t\tsetSunscreen(false);\n\t\t\treturn 0;\n\t\t  }\n\t\t});\n\t\tsetSunburn((prevSunburn) => stayInRange(prevSunburn + (uvRef.current / 2)));\n\t  } else {\n\t\tsetSunburn((prevSunburn) => stayInRange(prevSunburn + uvRef.current));\n\t  }\n\t  setBoredom((prevBoredom) => stayInRange(prevBoredom - 5));\n\t} else {\n\t  setSunburn((prevSunburn) => stayInRange(prevSunburn - 10));\n\t  setBoredom((prevBoredom) => stayInRange(prevBoredom + 5));\n\t}\n  };\n\n//   const cleanPet = () => {\n// \tif (!gameEnd) {\n// \t\tsetHealth((prev) => stayInRange(prev + 1));\n// \t}\n// }\n\n// const feedPet = () => {\n// \tif (!gameEnd) {\n// \t\tsetHunger((prev) => stayInRange(prev - 1));\n// \t}\n// }\n\n// const playPet = () => {\n// \tif (!gameEnd) {\n// \t\tsetHappiness((prev) => stayInRange(prev + (Math.floor(Math.random() * 5) + 1))); // random reduction between 1 -> 5)\n// \t}\n// }\n  const changeOutdoor = () => {\n\tif (!gameEnd) {\n\t\tsetOutdoor((prev) => !prev);\n\t}\n  }\n\n  const goInside = () => {\n\tif (!gameEnd) {\n\t\tsetOutdoor(false);\n\t}\n  }\n\n  const goOutside = () => {\n\tif (!gameEnd) {\n\t\tsetOutdoor(true);\n\t}\n  }\n\n  const applySunscreen = () => {\n\tif (!gameEnd) {\n\t\tsetSunscreen(true);\n\t\tsetSunscreenDuration(2);\n\n\t}\n  }\n\n\n  const resetGame = () => {  \t  \t\n  \tsetAge(0);\n\tsetSunburn(0);\n\tsetBoredom(0);\n\tsetSunscreen(false);\n\tsetGameEnd(false);\n  }\n\n  //helper functions\n  const handleDialogClose = () => {\n    setDialogOpen(false);\n  };\n\n  const handleOpenBanner = useCallback((text, eventTypeGraphic) => StaticBanner.show({\n  \t\ticon: <div />,\n  \t\ticonProps : {\n  \t\t\tsrc: eventTypeGraphic,\n  \t\t\tclassName:  classes.avatarLarge\n  \t\t},\n\t    open:  true,\n\t    label: text,\n   }), [classes.avatarLarge]);\n\n  const cleanup = () => {\n     //Cancel timers\n\t\tif (timeoutRef.current) {\n\t      timeoutRef.current.cancel();\n\t      \n\t    }\n\t    if (eventTimeoutRef.current) {\n\t\t  eventTimeoutRef.current.cancel();\n\t\t}\n\n\t\ttimeoutRef.current = null;\n\t\teventTimeoutRef.current = null;\n   }\n  \n  //Effects\n\n\n  useEffect(() => {\n\toutdoorRef.current = outdoor;\n  }, [outdoor]);\n  \n  useEffect(() => {\n\tsunscreenRef.current = sunscreen;\n  }, [sunscreen]);\n  \n  useEffect(() => {\n\tuvRef.current = uv;\n  }, [uv]);\n\n  useEffect(() => {\n   if (sunburn == 100 || boredom == 100) {   \t \n   \t setDialogOpen(true);\n\t setGameEnd(true);\n   }\n  }, [sunburn, boredom]);\n\n  useEffect(() => {\n    if (!gameEnd) {\n      // Set pet name if provided\n      if (petName !== undefined) {\n        setName(decodeURIComponent(petName));\n      }\n\n      // Set day duration\n      if (dayDurationInSeconds !== undefined && !Number.isNaN(parseInt(dayDurationInSeconds))) {\n        let inputedDuration = parseInt(dayDurationInSeconds);\n        if (inputedDuration <= 0) {\n          setDayDuration(1000);\n        } else if (inputedDuration > 60) {\n          setDayDuration(60 * 1000);\n        } else {\n          setDayDuration(inputedDuration * 1000);\n        }\n      } else {\n        setDayDuration(1000);\n      }\n\n      // Initialize game state\n      setSunburn(0);\n      setBoredom(0);\n      setOutdoor(true);\n      setSunscreen(false);\n      setSunscreenDuration(0);\n      setUv(5); // Starting UV index\n\n      // Start the game loop\n      beginLife();\n\n      // Schedule the first UV change\n      const uvChangeInterval = setInterval(() => {\n        setUv(Math.floor(Math.random() * 14) + 1);\n      }, 5 * dayDuration);\n\n      // Cleanup function\n      return () => {\n        cleanup();\n        clearInterval(uvChangeInterval);\n      };\n    } else {\n      cleanup();\n    }\n  }, [gameEnd, petName, dayDurationInSeconds, dayDuration]);\n\n  return (\n  \t<React.Fragment>\n  \t   <CssBaseline />\n  \t   <StaticBanner />\n\t\t<Grid container component=\"main\" className={classes.root}>\n\t      <Paper className={classes.paper}>\n\t        <Grid container spacing={2}>\n\t          <Grid item xs={8} sm={8} md={6} container>\n\t            <Grid item xs container direction=\"column\" spacing={2}>\n\t              <Grid item xs>\n\t                <Typography variant=\"h2\">\n\t                  {name}\n\t                </Typography>\n\t                <Typography variant=\"h6\">\n\t                  Age: {age}\n\t                </Typography>\n\t\t\t\t\t<Typography variant=\"body1\">\n\t                  Today's UV Index: {uv}\n\t                </Typography>\n\t\t\t\t\t<Typography variant=\"body1\">\n\t\t\t\t\t\tYou are currently {outdoor ? \"outdoors\" : \"indoors\"}\n\t\t\t\t\t</Typography>\n\t                 <Typography variant=\"body1\">\n\t                  Sunburn: \n\t                </Typography>\n\t                <LinearProgressWithLabel value={sunburn} />\n\t                <Typography variant=\"body1\">\n\t                  Boredom:  \n\t                </Typography>\n\t                <LinearProgressWithLabel value={boredom} />\n\t                \n\t                <ButtonGroup color=\"primary\" variant=\"contained\" aria-label=\"outlined primary button group\">\n\t\t\t\t\t<Button disabled={gameEnd} onClick={outdoor ? goInside : goOutside}>\n\t\t\t\t\t\t{outdoor ? 'Go Inside' : 'Play Outside'}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tdisabled={gameEnd || sunscreenDuration > 0}\n\t\t\t\t\t\tonClick={applySunscreen}\n\t\t\t\t\t\tclassName={classes.button}\n\t\t\t\t\t>\n\t\t\t\t\t\tApply Sunscreen\n\t\t\t\t\t\t{sunscreenDuration > 0 && (\n\t\t\t\t\t\t<CircularProgress\n\t\t\t\t\t\t\tvariant=\"static\"\n\t\t\t\t\t\t\tvalue={(sunscreenDuration / 2) * 100}\n\t\t\t\t\t\t\tsize={24} // Adjust size to fit your button\n\t\t\t\t\t\t\tclassName={classes.circularProgress}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\n\t\t\t  \t\t<Button onClick={resetGame}>{gameEnd? \"Play again!\" : \"Reset Game\"}</Button>\n\t              </Grid>\n\t            </Grid>\n\t          </Grid>\n\t          <Grid item xs={4} sm={4} md={6}>\n\t              {/* <Character name={name} happiness={happiness} age={age} health={health} /> */}\n\t          </Grid>    \n\t        </Grid>\n\t      </Paper>\n\t\t  <Copyright />\n    \t</Grid>\n    \t{gameEnd && \n    \t\t <Dialog\n\t\t        open={dialogOpen}\n\t\t        onClose={handleDialogClose}\n\t\t        aria-labelledby=\"alert-dialog-title\"\n\t\t        aria-describedby=\"alert-dialog-description\"\n\t\t      >\n\t\t        <DialogTitle id=\"alert-dialog-title\">Game Over.</DialogTitle>\n\t\t        <DialogContent>\n\t\t          <DialogContentText id=\"alert-dialog-description\">\n\t\t           Great job! Let's play again!\n\t\t          </DialogContentText>\n\t\t        </DialogContent>\n\t\t        <DialogActions>\n\t\t          <Button onClick={handleDialogClose} color=\"primary\">\n\t\t            Close\n\t\t          </Button>\n\t\t          <Button onClick={resetGame} color=\"primary\" autoFocus>\n\t\t            Start Over!\n\t\t          </Button>\n\t\t        </DialogActions>\n      \t\t</Dialog>\n    \t}\n    </React.Fragment>\n  )\n}"]},"metadata":{},"sourceType":"module"}