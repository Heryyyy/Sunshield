{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"/home/ashpool/Repositories/tamagotchi-virtual-pet/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"/home/ashpool/Repositories/tamagotchi-virtual-pet/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React,{useState,useEffect,useRef,useCallback}from'react';import outsideKid from\"../assets/character/outside.svg\";import sunburnKid from\"../assets/character/sunburnt.svg\";import indoorsKid from\"../assets/character/inside.svg\";import{useParams}from'react-router-dom';import{accurateInterval}from'../utils/helpers.js';import Copyright from'../components/Copyright';import Character from'../components/Character';import LinearProgressWithLabel from'../components/LinearProgressWithLabel';import Button from'@material-ui/core/Button';import ButtonGroup from'@material-ui/core/ButtonGroup';import CssBaseline from'@material-ui/core/CssBaseline';import Paper from'@material-ui/core/Paper';import Grid from'@material-ui/core/Grid';import Typography from'@material-ui/core/Typography';import Dialog from'@material-ui/core/Dialog';import DialogActions from'@material-ui/core/DialogActions';import DialogContent from'@material-ui/core/DialogContent';import DialogContentText from'@material-ui/core/DialogContentText';import DialogTitle from'@material-ui/core/DialogTitle';import{StaticBanner}from'material-ui-banner';import{makeStyles,createMuiTheme,ThemeProvider}from'@material-ui/core/styles';import CircularProgress from'@material-ui/core/CircularProgress';import Box from'@material-ui/core/Box';import Tooltip from'@material-ui/core/Tooltip';var theme=createMuiTheme({palette:{primary:{main:'#FF9800'// Orange\n},secondary:{main:'#009688'// Teal\n}},font:{family:''}});var useStyles=makeStyles(function(theme){var _ref;return _ref={root:{flexGrow:1,alignItems:'center',justifyContent:'center',flexDirection:'column',backgroundColor:'#ff9800',minHeight:'100vh'},paper:{padding:theme.spacing(3),margin:'2rem auto',maxWidth:'800px',width:'90%',backgroundColor:'#f2f4f5',// Updated this line\nborderRadius:'12px',boxShadow:'0 3px 10px rgba(0,0,0,0.1)'},avatarLarge:{width:72,height:72},buttonWrapper:{position:'relative'// display: 'inline-flex',\n// alignItems: 'center',\n},button:{position:'relative',overflow:'hidden'// Ensure child elements don't overflow\n},circularProgress:{position:'absolute',top:'30%',left:'45%',transform:'translate(-50%, -50%)'// color: 'yell', // Optional: Change color if needed\n},uvProgress:{position:'relative',display:'inline-flex',marginLeft:theme.spacing(1)},uvProgressLabel:{position:'absolute',top:'50%',left:'50%',transform:'translate(-50%, -50%)'},buttonGroup:{marginTop:theme.spacing(2)}},_defineProperty(_ref,\"button\",{margin:theme.spacing(1)}),_defineProperty(_ref,\"characterContainer\",{display:'flex',justifyContent:'center',alignItems:'center',height:'100%'}),_defineProperty(_ref,\"statLabel\",{fontWeight:'bold',marginRight:theme.spacing(1)}),_defineProperty(_ref,\"uvIndex\",{display:'flex',alignItems:'center',marginBottom:theme.spacing(1)}),_defineProperty(_ref,\"uvValue\",{fontWeight:'bold',marginLeft:theme.spacing(1)}),_ref;});//Helper functions\nfunction status(response){if(response.status>=200&&response.status<300){return Promise.resolve(response);}else if(response.status===429){return Promise.resolve(response);}else{return Promise.reject(new Error(response.statusText));}}function json(response){return response.json();}var stayInRange=function stayInRange(stat){if(stat>=0&&stat<=100)return stat;else if(stat>100)return 100;else return 0;};export default function App(){var _useState=useState('Pippin'),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(1000),_useState4=_slicedToArray(_useState3,2),dayDuration=_useState4[0],setDayDuration=_useState4[1];//in miliseconds\nvar _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),age=_useState6[0],setAge=_useState6[1];// const [health, setHealth] = useState(100);\n// const [hunger, setHunger] = useState(0);\n// const [happiness, setHappiness] = useState(100);\nvar _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),sunburn=_useState8[0],setSunburn=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),boredom=_useState10[0],setBoredom=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),outdoor=_useState12[0],setOutdoor=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),sunscreen=_useState14[0],setSunscreen=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),money=_useState16[0],setMoney=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),hat=_useState18[0],setHat=_useState18[1];var _useState19=useState(5),_useState20=_slicedToArray(_useState19,2),uv=_useState20[0],setUv=_useState20[1];var _useState21=useState(0),_useState22=_slicedToArray(_useState21,2),sunscreenDuration=_useState22[0],setSunscreenDuration=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),gameEnd=_useState24[0],setGameEnd=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),dialogOpen=_useState26[0],setDialogOpen=_useState26[1];var timeoutRef=useRef();var eventTimeoutRef=useRef();var classes=useStyles();var _useParams=useParams(),petName=_useParams.petName,dayDurationInSeconds=_useParams.dayDurationInSeconds;var outdoorRef=useRef(outdoor);var sunscreenRef=useRef(sunscreen);var uvRef=useRef(uv);var _useState27=useState(0),_useState28=_slicedToArray(_useState27,2),uvChangeProgress=_useState28[0],setUvChangeProgress=_useState28[1];var beginLife=function beginLife(){var timeOutInfo=accurateInterval(function(){petDay();},dayDuration);timeoutRef.current=timeOutInfo;//console.log(timeoutRef.current)\n};//   const handleNextEvent = (nextEvent) => {\n//   \t/*timeoutRef.current is null when starting a new game. \n//   \tThis condition also keeps the app from fetching when the game has ended\n//   \t*/\n//   \tif (timeoutRef.current !== null) {\n// \t  \tlet nextEventInfo = accurateInterval(() => {\n// \t          getNextEvent();\n// \t        }, nextEvent)\n// \t    eventTimeoutRef.current = nextEventInfo;\n//     \t//console.log(eventTimeoutRef.current);\n//     }\n//   }\n//   const getNextEvent = () => {\n// \t\tfetch('https://www.virtual-pet.uk/v1/event')\n// \t\t\t.then(status)\n// \t\t\t.then(json)\n// \t\t\t.then(function(data) {\n// \t\t\t    if(data.type === 'Error'){\n// \t\t\t    \t console.log('Request failed', data);\n// \t\t\t    \t if (eventTimeoutRef.current) {\n// \t\t\t\t\t\t    eventTimeoutRef.current.cancel();\n// \t\t\t\t\t\t    eventTimeoutRef.current = null;\n// \t\t\t\t\t\t }\n// \t\t\t    \t handleNextEvent(data.nextEvent * dayDuration);\n// \t\t\t    } else {\n// \t\t\t    \tconsole.log('Request succeeded with JSON response', data);\n// \t\t\t\t    setHealth((prev) => stayInRange(prev + data.impact.health));\n// \t\t\t\t\tsetHunger((prev) => stayInRange(prev + data.impact.hunger));\n// \t\t\t\t\tsetHappiness((prev) => stayInRange(prev + data.impact.happiness));\n// \t\t\t\t\thandleOpenBanner(data.type.toUpperCase() + \"! \" + data.title + \": \" + data.description + \" Impact, health: \" + data.impact.health + \" hunger: \" + data.impact.hunger + \" happiness: \" + data.impact.happiness, getCharacter(data.type));\n// \t\t\t\t\tif (eventTimeoutRef.current) {\n// \t\t\t\t\t\t    eventTimeoutRef.current.cancel();\n// \t\t\t\t\t\t    eventTimeoutRef.current = null;\n// \t\t\t\t\t\t }\n// \t\t\t\t\thandleNextEvent(data.nextEvent * dayDuration); \n// \t\t\t\t}\t\t\t    \t\n// \t\t\t }).catch(function(error) {\n// \t\t\t    console.log('Request failed', error);\n// \t\t\t });\n//   }\nvar petDay=function petDay(){setAge(function(prevAge){var newAge=prevAge+1;var daysUntilUvChange=(5-newAge%5)%5;if(daysUntilUvChange===0){setUv(Math.floor(Math.random()*14)+1);}setUvChangeProgress((5-daysUntilUvChange)/5*100);return newAge;});if(outdoorRef.current){if(sunscreenRef.current){setSunscreenDuration(function(prevDuration){if(prevDuration>0){return prevDuration-1;}else{setSunscreen(false);return 0;}});setSunburn(function(prevSunburn){return stayInRange(prevSunburn+uvRef.current/2);});}else{setSunburn(function(prevSunburn){return stayInRange(prevSunburn+uvRef.current);});}setBoredom(function(prevBoredom){return stayInRange(prevBoredom-5);});}else{setSunburn(function(prevSunburn){return stayInRange(prevSunburn-10);});setBoredom(function(prevBoredom){return stayInRange(prevBoredom+5);});}};//   const cleanPet = () => {\n// \tif (!gameEnd) {\n// \t\tsetHealth((prev) => stayInRange(prev + 1));\n// \t}\n// }\n// const feedPet = () => {\n// \tif (!gameEnd) {\n// \t\tsetHunger((prev) => stayInRange(prev - 1));\n// \t}\n// }\n// const playPet = () => {\n// \tif (!gameEnd) {\n// \t\tsetHappiness((prev) => stayInRange(prev + (Math.floor(Math.random() * 5) + 1))); // random reduction between 1 -> 5)\n// \t}\n// }\nvar goInside=function goInside(){if(!gameEnd){setOutdoor(false);setSunscreen(false);setSunscreenDuration(0);}};var goOutside=function goOutside(){if(!gameEnd){setOutdoor(true);}};var applySunscreen=function applySunscreen(){if(!gameEnd){if(money>=5){setMoney(function(prevMoney){return prevMoney-5;});setSunscreen(true);setSunscreenDuration(5);}}};var doChores=function doChores(){if(!gameEnd){setMoney(function(prevMoney){return prevMoney+1;});setBoredom(function(prevBoredom){return stayInRange(prevBoredom+10);});}};var resetGame=function resetGame(){setAge(0);setSunburn(0);setBoredom(0);setSunscreen(false);setGameEnd(false);setMoney(0);};//helper functions\nvar handleDialogClose=function handleDialogClose(){setDialogOpen(false);};var handleOpenBanner=useCallback(function(text,eventTypeGraphic){return StaticBanner.show({icon:/*#__PURE__*/_jsx(\"div\",{}),iconProps:{src:eventTypeGraphic,className:classes.avatarLarge},open:true,label:text});},[classes.avatarLarge]);var cleanup=function cleanup(){//Cancel timers\nif(timeoutRef.current){timeoutRef.current.cancel();}if(eventTimeoutRef.current){eventTimeoutRef.current.cancel();}timeoutRef.current=null;eventTimeoutRef.current=null;};//Effects\nuseEffect(function(){outdoorRef.current=outdoor;},[outdoor]);useEffect(function(){sunscreenRef.current=sunscreen;},[sunscreen]);useEffect(function(){uvRef.current=uv;},[uv]);useEffect(function(){if(sunburn==100||boredom==100){setDialogOpen(true);setGameEnd(true);}},[sunburn,boredom]);useEffect(function(){if(!gameEnd){// Set pet name if provided\nif(petName!==undefined){setName(decodeURIComponent(petName));}// Set day duration\nif(dayDurationInSeconds!==undefined&&!Number.isNaN(parseInt(dayDurationInSeconds))){var inputedDuration=parseInt(dayDurationInSeconds);if(inputedDuration<=0){setDayDuration(1000);}else if(inputedDuration>60){setDayDuration(60*1000);}else{setDayDuration(inputedDuration*1000);}}else{setDayDuration(1000);}// Initialize game state\nsetSunburn(0);setBoredom(0);setOutdoor(true);setSunscreen(false);setSunscreenDuration(0);setUv(5);// Starting UV index\n// Start the game loop\nbeginLife();// Schedule the first UV change\nvar uvChangeInterval=setInterval(function(){setUv(Math.floor(Math.random()*14)+1);},5*dayDuration);// Cleanup function\nreturn function(){cleanup();clearInterval(uvChangeInterval);};}else{cleanup();}},[gameEnd,petName,dayDurationInSeconds,dayDuration]);var daysUntilUvChange=(5-age%5)%5;var getCharacterImage=function getCharacterImage(){if(outdoor){if(sunburn>50){return sunburnKid;}return outsideKid;}return indoorsKid;};return/*#__PURE__*/_jsx(ThemeProvider,{theme:theme,children:/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsx(StaticBanner,{}),/*#__PURE__*/_jsxs(Grid,{container:true,component:\"main\",className:classes.root,children:[/*#__PURE__*/_jsx(Paper,{className:classes.paper,children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h3\",gutterBottom:true,children:name}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",gutterBottom:true,children:[\"Age: \",age]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.uvIndex,children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:\"Today's UV Index:\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",className:classes.uvValue,style:{color:uv>10?'red':uv>5?'orange':'green'},children:uv}),/*#__PURE__*/_jsxs(Box,{position:\"relative\",display:\"inline-flex\",marginLeft:1,children:[/*#__PURE__*/_jsx(CircularProgress,{variant:\"determinate\",value:uvChangeProgress,size:24}),/*#__PURE__*/_jsx(Box,{top:0,left:0,bottom:0,right:0,position:\"absolute\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",children:/*#__PURE__*/_jsx(Typography,{variant:\"caption\",component:\"div\",color:\"textSecondary\",children:daysUntilUvChange})})]})]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",gutterBottom:true,children:[\"Coins: \",money]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",gutterBottom:true,children:[\"You are currently \",outdoor?\"outdoors\":\"indoors\"]}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",className:classes.statLabel,children:\"Sunburn:\"}),/*#__PURE__*/_jsx(LinearProgressWithLabel,{value:sunburn}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",className:classes.statLabel,children:\"Boredom:\"}),/*#__PURE__*/_jsx(LinearProgressWithLabel,{value:boredom}),/*#__PURE__*/_jsxs(ButtonGroup,{color:\"primary\",variant:\"contained\",className:classes.buttonGroup,children:[/*#__PURE__*/_jsx(Button,{disabled:gameEnd,onClick:outdoor?goInside:goOutside,className:classes.button,children:outdoor?'Go Inside':'Play Outside'}),outdoor&&/*#__PURE__*/_jsx(Tooltip,{title:\"Spend 5 coins to reduce sunburn for 5 days\",arrow:true,placement:\"top\",leaveDelay:200,style:{fontSize:'1.2em'},children:/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsxs(Button,{disabled:gameEnd||sunscreenDuration>0||money<5,onClick:applySunscreen,className:classes.button,children:[\"Apply Sunscreen\",sunscreenDuration>0&&/*#__PURE__*/_jsx(CircularProgress,{variant:\"static\",value:sunscreenDuration/5*100,size:24,className:classes.circularProgress})]})})}),!outdoor&&/*#__PURE__*/_jsx(Button,{disabled:gameEnd,onClick:doChores,className:classes.button,children:\"Do Chores\"})]}),/*#__PURE__*/_jsx(Button,{onClick:resetGame,variant:\"outlined\",color:\"secondary\",className:classes.button,children:gameEnd?\"Play again!\":\"Reset Game\"})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(\"div\",{className:classes.characterContainer,children:/*#__PURE__*/_jsx(Character,{name:name,age:age,image:getCharacterImage(),sunburn:sunburn,boredom:boredom,outdoors:outdoor,sunscreen:sunscreen})})})]})}),/*#__PURE__*/_jsx(Copyright,{})]}),gameEnd&&/*#__PURE__*/_jsxs(Dialog,{open:dialogOpen,onClose:handleDialogClose,\"aria-labelledby\":\"alert-dialog-title\",\"aria-describedby\":\"alert-dialog-description\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"alert-dialog-title\",children:\"Game Over.\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(DialogContentText,{id:\"alert-dialog-description\",children:\"Let's play again!\"})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleDialogClose,color:\"primary\",children:\"Close\"}),/*#__PURE__*/_jsx(Button,{onClick:resetGame,color:\"primary\",autoFocus:true,children:\"Start Over!\"})]})]})]})});}","map":{"version":3,"sources":["/home/ashpool/Repositories/tamagotchi-virtual-pet/src/containers/App.js"],"names":["React","useState","useEffect","useRef","useCallback","useParams","accurateInterval","Copyright","Character","LinearProgressWithLabel","Button","ButtonGroup","CssBaseline","Paper","Grid","Typography","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","StaticBanner","makeStyles","createMuiTheme","ThemeProvider","CircularProgress","Box","Tooltip","theme","palette","primary","main","secondary","font","family","useStyles","root","flexGrow","alignItems","justifyContent","flexDirection","backgroundColor","minHeight","paper","padding","spacing","margin","maxWidth","width","borderRadius","boxShadow","avatarLarge","height","buttonWrapper","position","button","overflow","circularProgress","top","left","transform","uvProgress","display","marginLeft","uvProgressLabel","buttonGroup","marginTop","fontWeight","marginRight","marginBottom","status","response","Promise","resolve","reject","Error","statusText","json","stayInRange","stat","App","name","setName","dayDuration","setDayDuration","age","setAge","sunburn","setSunburn","boredom","setBoredom","outdoor","setOutdoor","sunscreen","setSunscreen","money","setMoney","hat","setHat","uv","setUv","sunscreenDuration","setSunscreenDuration","gameEnd","setGameEnd","dialogOpen","setDialogOpen","timeoutRef","eventTimeoutRef","classes","petName","dayDurationInSeconds","outdoorRef","sunscreenRef","uvRef","uvChangeProgress","setUvChangeProgress","beginLife","timeOutInfo","petDay","current","prevAge","newAge","daysUntilUvChange","Math","floor","random","prevDuration","prevSunburn","prevBoredom","goInside","goOutside","applySunscreen","prevMoney","doChores","resetGame","handleDialogClose","handleOpenBanner","text","eventTypeGraphic","show","icon","iconProps","src","className","open","label","cleanup","cancel","undefined","decodeURIComponent","Number","isNaN","parseInt","inputedDuration","uvChangeInterval","setInterval","clearInterval","getCharacterImage","sunburnKid","outsideKid","indoorsKid","uvIndex","uvValue","color","statLabel","fontSize","characterContainer"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useRef, useCallback} from 'react';\nimport outsideKid from '../assets/character/outside.svg';\nimport sunburnKid from '../assets/character/sunburnt.svg';\nimport indoorsKid from '../assets/character/inside.svg';\nimport {useParams} from 'react-router-dom';\nimport {accurateInterval} from '../utils/helpers.js';\nimport Copyright from '../components/Copyright';\nimport Character from '../components/Character';\nimport LinearProgressWithLabel from '../components/LinearProgressWithLabel';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { StaticBanner } from 'material-ui-banner';\nimport { makeStyles, createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Box from '@material-ui/core/Box';\nimport Tooltip from '@material-ui/core/Tooltip';\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#FF9800', // Orange\n    },\n    secondary: {\n      main: '#009688', // Teal\n    },\n  },\n  font: {\n\tfamily: ''\n  }\n});\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    flexDirection: 'column',\n    backgroundColor: '#ff9800',\n    minHeight: '100vh',\n  },\n  paper: {\n    padding: theme.spacing(3),\n    margin: '2rem auto',\n    maxWidth: '800px',\n    width: '90%',\n    backgroundColor: '#f2f4f5', // Updated this line\n    borderRadius: '12px',\n    boxShadow: '0 3px 10px rgba(0,0,0,0.1)',\n  },\n  avatarLarge: {\n  \twidth: 72,\n    height: 72,\n  },\n  buttonWrapper: {\n    position: 'relative',\n    // display: 'inline-flex',\n    // alignItems: 'center',\n  },\n  button: {\n    position: 'relative',\n    overflow: 'hidden', // Ensure child elements don't overflow\n  },\n  circularProgress: {\n    position: 'absolute',\n    top: '30%',\n    left: '45%',\n    transform: 'translate(-50%, -50%)',\n    // color: 'yell', // Optional: Change color if needed\n  },\n  uvProgress: {\n    position: 'relative',\n    display: 'inline-flex',\n    marginLeft: theme.spacing(1),\n  },\n  uvProgressLabel: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    transform: 'translate(-50%, -50%)',\n  },\n  buttonGroup: {\n    marginTop: theme.spacing(2),\n  },\n  button: {\n    margin: theme.spacing(1),\n  },\n  characterContainer: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    height: '100%',\n  },\n  statLabel: {\n    fontWeight: 'bold',\n    marginRight: theme.spacing(1),\n  },\n  uvIndex: {\n    display: 'flex',\n    alignItems: 'center',\n    marginBottom: theme.spacing(1),\n  },\n  uvValue: {\n    fontWeight: 'bold',\n    marginLeft: theme.spacing(1),\n  },\n}));\n\n//Helper functions\n \n function status(response) {\n  if (response.status >= 200 && response.status < 300) {\n    return Promise.resolve(response)\n  } else if (response.status === 429){\n    return Promise.resolve(response)\n  }else {\n    return Promise.reject(new Error(response.statusText))\n  }\n }\n\n function json(response) {\n  return response.json()\n }\n\n const stayInRange = (stat) => {\n  \tif (stat >= 0 && stat <= 100)\n\t    return stat;\n\t else if (stat > 100)\n\t    return 100;\n\telse\n\t    return 0;\n  }\n\n\n\n\nexport default function App() {\n\nconst [name, setName] = useState('Pippin');\nconst [dayDuration, setDayDuration] = useState(1000); //in miliseconds\nconst [age, setAge] = useState(0);\n\n\n\n// const [health, setHealth] = useState(100);\n// const [hunger, setHunger] = useState(0);\n// const [happiness, setHappiness] = useState(100);\n\nconst [sunburn, setSunburn] = useState(0);\nconst [boredom, setBoredom] = useState(0);\nconst [outdoor, setOutdoor] = useState(true);\nconst [sunscreen, setSunscreen] = useState(false);\nconst [money, setMoney] = useState(0);\nconst [hat, setHat] = useState(false);\nconst [uv, setUv] = useState(5);\nconst [sunscreenDuration, setSunscreenDuration] = useState(0);\n\nconst [gameEnd, setGameEnd] = useState(false);\nconst [dialogOpen, setDialogOpen] = useState(false);\nconst timeoutRef = useRef();\nconst eventTimeoutRef = useRef();\nconst classes = useStyles();\nconst {petName, dayDurationInSeconds} = useParams();\n\nconst outdoorRef = useRef(outdoor);\nconst sunscreenRef = useRef(sunscreen);\nconst uvRef = useRef(uv);\nconst [uvChangeProgress, setUvChangeProgress] = useState(0);\n\n\n\n\n const beginLife = () => {\n    let timeOutInfo = accurateInterval(() => {\n          petDay();\n        }, dayDuration) \n    timeoutRef.current = timeOutInfo;\n    //console.log(timeoutRef.current)\n }\n\n//   const handleNextEvent = (nextEvent) => {\n//   \t/*timeoutRef.current is null when starting a new game. \n//   \tThis condition also keeps the app from fetching when the game has ended\n//   \t*/\n//   \tif (timeoutRef.current !== null) {\n// \t  \tlet nextEventInfo = accurateInterval(() => {\n// \t          getNextEvent();\n// \t        }, nextEvent)\n// \t    eventTimeoutRef.current = nextEventInfo;\n//     \t//console.log(eventTimeoutRef.current);\n//     }\n//   }\n\n//   const getNextEvent = () => {\n  \t\n// \t\tfetch('https://www.virtual-pet.uk/v1/event')\n// \t\t\t.then(status)\n// \t\t\t.then(json)\n// \t\t\t.then(function(data) {\n// \t\t\t    if(data.type === 'Error'){\n// \t\t\t    \t console.log('Request failed', data);\n// \t\t\t    \t if (eventTimeoutRef.current) {\n// \t\t\t\t\t\t    eventTimeoutRef.current.cancel();\n// \t\t\t\t\t\t    eventTimeoutRef.current = null;\n// \t\t\t\t\t\t }\n// \t\t\t    \t handleNextEvent(data.nextEvent * dayDuration);\n// \t\t\t    } else {\n// \t\t\t    \tconsole.log('Request succeeded with JSON response', data);\n// \t\t\t\t    setHealth((prev) => stayInRange(prev + data.impact.health));\n// \t\t\t\t\tsetHunger((prev) => stayInRange(prev + data.impact.hunger));\n// \t\t\t\t\tsetHappiness((prev) => stayInRange(prev + data.impact.happiness));\n// \t\t\t\t\thandleOpenBanner(data.type.toUpperCase() + \"! \" + data.title + \": \" + data.description + \" Impact, health: \" + data.impact.health + \" hunger: \" + data.impact.hunger + \" happiness: \" + data.impact.happiness, getCharacter(data.type));\n// \t\t\t\t\tif (eventTimeoutRef.current) {\n// \t\t\t\t\t\t    eventTimeoutRef.current.cancel();\n// \t\t\t\t\t\t    eventTimeoutRef.current = null;\n// \t\t\t\t\t\t }\n// \t\t\t\t\thandleNextEvent(data.nextEvent * dayDuration); \n// \t\t\t\t}\t\t\t    \t\n\n// \t\t\t }).catch(function(error) {\n// \t\t\t    console.log('Request failed', error);\n// \t\t\t });\n\t\t  \t\n//   }\n\n const petDay = () => {\n\tsetAge((prevAge) => {\n\t  const newAge = prevAge + 1;\n\t  const daysUntilUvChange = (5 - (newAge % 5)) % 5;\n\t  if (daysUntilUvChange === 0) {\n\t\tsetUv(Math.floor(Math.random() * 14) + 1);\n\t  }\n\t  setUvChangeProgress(((5 - daysUntilUvChange) / 5) * 100);\n\t  return newAge;\n\t});\n  \n\tif (outdoorRef.current) {\n\t  if (sunscreenRef.current) {\n\t\tsetSunscreenDuration((prevDuration) => {\n\t\t  if (prevDuration > 0) {\n\t\t\treturn prevDuration - 1;\n\t\t  } else {\n\t\t\tsetSunscreen(false);\n\t\t\treturn 0;\n\t\t  }\n\t\t});\n\t\tsetSunburn((prevSunburn) => stayInRange(prevSunburn + (uvRef.current / 2)));\n\t  } else {\n\t\tsetSunburn((prevSunburn) => stayInRange(prevSunburn + uvRef.current));\n\t  }\n\t  setBoredom((prevBoredom) => stayInRange(prevBoredom - 5));\n\t} else {\n\t  setSunburn((prevSunburn) => stayInRange(prevSunburn - 10));\n\t  setBoredom((prevBoredom) => stayInRange(prevBoredom + 5));\n\t}\n  };\n\n//   const cleanPet = () => {\n// \tif (!gameEnd) {\n// \t\tsetHealth((prev) => stayInRange(prev + 1));\n// \t}\n// }\n\n// const feedPet = () => {\n// \tif (!gameEnd) {\n// \t\tsetHunger((prev) => stayInRange(prev - 1));\n// \t}\n// }\n\n// const playPet = () => {\n// \tif (!gameEnd) {\n// \t\tsetHappiness((prev) => stayInRange(prev + (Math.floor(Math.random() * 5) + 1))); // random reduction between 1 -> 5)\n// \t}\n// }\n\n  const goInside = () => {\n\tif (!gameEnd) {\n\t\tsetOutdoor(false);\n\t\tsetSunscreen(false);\n\t\tsetSunscreenDuration(0);\n\t}\n  }\n\n  const goOutside = () => {\n\tif (!gameEnd) {\n\t\tsetOutdoor(true);\n\t}\n  }\n\n  const applySunscreen = () => {\n\tif (!gameEnd) {\n\t\tif (money >= 5) {\n\t\t\tsetMoney((prevMoney) => prevMoney - 5);\n\t\t\tsetSunscreen(true);\n\t\t\tsetSunscreenDuration(5);\n\n\t}\n  }}\n\n  const doChores = () => {\n\tif (!gameEnd) {\n\t  setMoney((prevMoney) => prevMoney + 1);\n\t  setBoredom((prevBoredom) => stayInRange(prevBoredom + 10));\n\t}\n  };\n\n\n  const resetGame = () => {  \t  \t\n  \tsetAge(0);\n\tsetSunburn(0);\n\tsetBoredom(0);\n\tsetSunscreen(false);\n\tsetGameEnd(false);\n\tsetMoney(0);\n  }\n\n  //helper functions\n  const handleDialogClose = () => {\n    setDialogOpen(false);\n  };\n\n  const handleOpenBanner = useCallback((text, eventTypeGraphic) => StaticBanner.show({\n  \t\ticon: <div />,\n  \t\ticonProps : {\n  \t\t\tsrc: eventTypeGraphic,\n  \t\t\tclassName:  classes.avatarLarge\n  \t\t},\n\t    open:  true,\n\t    label: text,\n   }), [classes.avatarLarge]);\n\n  const cleanup = () => {\n     //Cancel timers\n\t\tif (timeoutRef.current) {\n\t      timeoutRef.current.cancel();\n\t      \n\t    }\n\t    if (eventTimeoutRef.current) {\n\t\t  eventTimeoutRef.current.cancel();\n\t\t}\n\n\t\ttimeoutRef.current = null;\n\t\teventTimeoutRef.current = null;\n   }\n  \n  //Effects\n\n\n  useEffect(() => {\n\toutdoorRef.current = outdoor;\n  }, [outdoor]);\n  \n  useEffect(() => {\n\tsunscreenRef.current = sunscreen;\n  }, [sunscreen]);\n  \n  useEffect(() => {\n\tuvRef.current = uv;\n  }, [uv]);\n\n  useEffect(() => {\n   if (sunburn == 100 || boredom == 100) {   \t \n   \t setDialogOpen(true);\n\t setGameEnd(true);\n   }\n  }, [sunburn, boredom]);\n\n  useEffect(() => {\n    if (!gameEnd) {\n      // Set pet name if provided\n      if (petName !== undefined) {\n        setName(decodeURIComponent(petName));\n      }\n\n      // Set day duration\n      if (dayDurationInSeconds !== undefined && !Number.isNaN(parseInt(dayDurationInSeconds))) {\n        let inputedDuration = parseInt(dayDurationInSeconds);\n        if (inputedDuration <= 0) {\n          setDayDuration(1000);\n        } else if (inputedDuration > 60) {\n          setDayDuration(60 * 1000);\n        } else {\n          setDayDuration(inputedDuration * 1000);\n        }\n      } else {\n        setDayDuration(1000);\n      }\n\n      // Initialize game state\n      setSunburn(0);\n      setBoredom(0);\n      setOutdoor(true);\n      setSunscreen(false);\n      setSunscreenDuration(0);\n      setUv(5); // Starting UV index\n\n      // Start the game loop\n      beginLife();\n\n      // Schedule the first UV change\n      const uvChangeInterval = setInterval(() => {\n        setUv(Math.floor(Math.random() * 14) + 1);\n      }, 5 * dayDuration);\n\n      // Cleanup function\n      return () => {\n        cleanup();\n        clearInterval(uvChangeInterval);\n      };\n    } else {\n      cleanup();\n    }\n  }, [gameEnd, petName, dayDurationInSeconds, dayDuration]);\n\n  const daysUntilUvChange = (5 - (age % 5)) % 5;\n\n  const getCharacterImage = () => {\n    if (outdoor) {\n      if (sunburn > 50) {\n        return sunburnKid;\n      }\n      return outsideKid;\n    }\n    return indoorsKid;\n  };\n\n\n  return (\n    <ThemeProvider theme={theme}>\n      <React.Fragment>\n        <CssBaseline />\n        <StaticBanner />\n        <Grid container component=\"main\" className={classes.root}>\n          <Paper className={classes.paper}>\n            <Grid container spacing={3}>\n              <Grid item xs={12} md={6}>\n                <Typography variant=\"h3\" gutterBottom>\n                  {name}\n                </Typography>\n                <Typography variant=\"h6\" gutterBottom>\n                  Age: {age}\n                </Typography>\n                <div className={classes.uvIndex}>\n                  <Typography variant=\"body1\">Today's UV Index:</Typography>\n                  <Typography\n                    variant=\"body1\"\n                    className={classes.uvValue}\n                    style={{ color: uv > 10 ? 'red' : uv > 5 ? 'orange' : 'green' }}\n                  >\n                    {uv}\n                  </Typography>\n                  <Box position=\"relative\" display=\"inline-flex\" marginLeft={1}>\n                    <CircularProgress variant=\"determinate\" value={uvChangeProgress} size={24} />\n                    <Box\n                      top={0}\n                      left={0}\n                      bottom={0}\n                      right={0}\n                      position=\"absolute\"\n                      display=\"flex\"\n                      alignItems=\"center\"\n                      justifyContent=\"center\"\n                    >\n                      <Typography variant=\"caption\" component=\"div\" color=\"textSecondary\">\n                        {daysUntilUvChange}\n                      </Typography>\n                    </Box>\n                  </Box>\n                </div>\n                <Typography variant=\"body1\" gutterBottom>\n                  Coins: {money}\n                </Typography>\n                <Typography variant=\"body1\" gutterBottom>\n                  You are currently {outdoor ? \"outdoors\" : \"indoors\"}\n                </Typography>\n                <Typography variant=\"body1\" className={classes.statLabel}>\n                  Sunburn:\n                </Typography>\n                <LinearProgressWithLabel value={sunburn} />\n                <Typography variant=\"body1\" className={classes.statLabel}>\n                  Boredom:\n                </Typography>\n                <LinearProgressWithLabel value={boredom} />\n                \n                <ButtonGroup color=\"primary\" variant=\"contained\" className={classes.buttonGroup}>\n                  <Button\n                    disabled={gameEnd}\n                    onClick={outdoor ? goInside : goOutside}\n                    className={classes.button}\n                  >\n                    {outdoor ? 'Go Inside' : 'Play Outside'}\n                  </Button>\n                  {outdoor && (\n                    <Tooltip title={`Spend 5 coins to reduce sunburn for 5 days`} arrow placement=\"top\"  leaveDelay={200} style={{ fontSize: '1.2em' }}>\n                      <span>\n                        <Button\n                          disabled={gameEnd || sunscreenDuration > 0 || money < 5}\n                          onClick={applySunscreen}\n                          className={classes.button}\n                        >\n                          Apply Sunscreen\n                          {sunscreenDuration > 0 && (\n                            <CircularProgress\n                              variant=\"static\"\n                              value={(sunscreenDuration / 5) * 100}\n                              size={24}\n                              className={classes.circularProgress}\n                            />\n                          )}\n                        </Button>\n                      </span>\n                    </Tooltip>\n                  )}\n                  {!outdoor && (\n                    <Button\n                      disabled={gameEnd}\n                      onClick={doChores}\n                      className={classes.button}\n                    >\n                      Do Chores\n                    </Button>\n                  )}\n                </ButtonGroup>\n                <Button\n                  onClick={resetGame}\n                  variant=\"outlined\"\n                  color=\"secondary\"\n                  className={classes.button}\n                >\n                  {gameEnd ? \"Play again!\" : \"Reset Game\"}\n                </Button>\n              </Grid>\n              <Grid item xs={12} md={6}>\n                <div className={classes.characterContainer}>\n                  <Character\n                    name={name}\n                    age={age}\n                    image={getCharacterImage()}\n                    sunburn={sunburn}\n                    boredom={boredom}\n                    outdoors={outdoor}\n\t\t\t\t\tsunscreen={sunscreen}\n                  />\n                </div>\n              </Grid>\n            </Grid>\n          </Paper>\n          <Copyright />\n        </Grid>\n        {gameEnd && \n          <Dialog\n            open={dialogOpen}\n            onClose={handleDialogClose}\n            aria-labelledby=\"alert-dialog-title\"\n            aria-describedby=\"alert-dialog-description\"\n          >\n            <DialogTitle id=\"alert-dialog-title\">Game Over.</DialogTitle>\n            <DialogContent>\n              <DialogContentText id=\"alert-dialog-description\">\n                Let's play again!\n              </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n              <Button onClick={handleDialogClose} color=\"primary\">\n                Close\n              </Button>\n              <Button onClick={resetGame} color=\"primary\" autoFocus>\n                Start Over!\n              </Button>\n            </DialogActions>\n          </Dialog>\n        }\n      </React.Fragment>\n    </ThemeProvider>\n  )\n}"]},"metadata":{},"sourceType":"module"}